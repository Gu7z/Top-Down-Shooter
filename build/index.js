var E=Object.defineProperty;var A=(r,e,i)=>e in r?E(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i;var d=(r,e,i)=>(A(r,typeof e!="symbol"?e+"":e,i),i);function D(r,e){var i=Math.random()*(e-r)+r;return Math.floor(i)}var m=D;var w=class{constructor({app:e}){this.app=e,this.width=50,this.height=50,this.buffDuration=5e3,this.createBuff({app:e})}createBuff({app:e}){let i=m(this.width,this.app.screen.width-this.width),o=m(this.height,this.app.screen.height-this.height);this.buff=new PIXI.Sprite(PIXI.Texture.WHITE),this.buff.position.set(i,o),this.buff.tint=16755200,this.buff.width=this.width,this.buff.height=this.height,this.text=new PIXI.Text("Buff",{fill:16777215}),this.text.position.set(i,o),e.stage.addChild(this.buff),e.stage.addChild(this.text)}get(e){e.shooting.setFireVelocity=3,e.velocity=3,setTimeout(()=>{e.shooting.setFireVelocity=1,e.velocity=2},this.buffDuration)}update(e){if(this.buff.destroyed)return;let i=e.player.getBounds(),o=this.buff.getBounds();if(i.x+i.width>o.x&&i.x<o.x+o.width&&i.y+i.height>o.y&&i.y<o.y+o.height&&this.buff.visible){this.destroy(),this.get(e);let h=setInterval(()=>{this.createBuff({app:this.app}),clearInterval(h)},1e4)}}destroy(){this.buff.destroy(),this.text.destroy()}},X=w;function q(r,e,i){return i={path:e,exports:{},require:function(o,n){return j(o,n==null?i.path:n)}},r(i,i.exports),i.exports}function j(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var F=q(function(r,e){r.exports=i;function i(t,s){if(!(this instanceof i))return new i(t,s);this.x=t||0,this.y=s||0}i.fromArray=function(t){return new i(t[0]||0,t[1]||0)},i.fromObject=function(t){return new i(t.x||0,t.y||0)},i.prototype.addX=function(t){return this.x+=t.x,this},i.prototype.addY=function(t){return this.y+=t.y,this},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},i.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},i.prototype.addScalarX=function(t){return this.x+=t,this},i.prototype.addScalarY=function(t){return this.y+=t,this},i.prototype.subtractX=function(t){return this.x-=t.x,this},i.prototype.subtractY=function(t){return this.y-=t.y,this},i.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},i.prototype.subtractScalar=function(t){return this.x-=t,this.y-=t,this},i.prototype.subtractScalarX=function(t){return this.x-=t,this},i.prototype.subtractScalarY=function(t){return this.y-=t,this},i.prototype.divideX=function(t){return this.x/=t.x,this},i.prototype.divideY=function(t){return this.y/=t.y,this},i.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},i.prototype.divideScalar=function(t){return t!==0?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this},i.prototype.divideScalarX=function(t){return t!==0?this.x/=t:this.x=0,this},i.prototype.divideScalarY=function(t){return t!==0?this.y/=t:this.y=0,this},i.prototype.invertX=function(){return this.x*=-1,this},i.prototype.invertY=function(){return this.y*=-1,this},i.prototype.invert=function(){return this.invertX(),this.invertY(),this},i.prototype.multiplyX=function(t){return this.x*=t.x,this},i.prototype.multiplyY=function(t){return this.y*=t.y,this},i.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},i.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},i.prototype.multiplyScalarX=function(t){return this.x*=t,this},i.prototype.multiplyScalarY=function(t){return this.y*=t,this},i.prototype.normalize=function(){var t=this.length();return t===0?(this.x=1,this.y=0):this.divide(i(t,t)),this},i.prototype.norm=i.prototype.normalize,i.prototype.limit=function(t,s){return Math.abs(this.x)>t&&(this.x*=s),Math.abs(this.y)>t&&(this.y*=s),this},i.prototype.randomize=function(t,s){return this.randomizeX(t,s),this.randomizeY(t,s),this},i.prototype.randomizeX=function(t,s){var y=Math.min(t.x,s.x),x=Math.max(t.x,s.x);return this.x=n(y,x),this},i.prototype.randomizeY=function(t,s){var y=Math.min(t.y,s.y),x=Math.max(t.y,s.y);return this.y=n(y,x),this},i.prototype.randomizeAny=function(t,s){return Math.round(Math.random())?this.randomizeX(t,s):this.randomizeY(t,s),this},i.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},i.prototype.toFixed=function(t){return typeof t=="undefined"&&(t=8),this.x=this.x.toFixed(t),this.y=this.y.toFixed(t),this},i.prototype.mixX=function(t,s){return typeof s=="undefined"&&(s=.5),this.x=(1-s)*this.x+s*t.x,this},i.prototype.mixY=function(t,s){return typeof s=="undefined"&&(s=.5),this.y=(1-s)*this.y+s*t.y,this},i.prototype.mix=function(t,s){return this.mixX(t,s),this.mixY(t,s),this},i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.copyX=function(t){return this.x=t.x,this},i.prototype.copyY=function(t){return this.y=t.y,this},i.prototype.copy=function(t){return this.copyX(t),this.copyY(t),this},i.prototype.zero=function(){return this.x=this.y=0,this},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y},i.prototype.cross=function(t){return this.x*t.y-this.y*t.x},i.prototype.projectOnto=function(t){var s=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=s*t.x,this.y=s*t.y,this},i.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},i.prototype.horizontalAngleDeg=function(){return h(this.horizontalAngle())},i.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},i.prototype.verticalAngleDeg=function(){return h(this.verticalAngle())},i.prototype.angle=i.prototype.horizontalAngle,i.prototype.angleDeg=i.prototype.horizontalAngleDeg,i.prototype.direction=i.prototype.horizontalAngle,i.prototype.rotate=function(t){var s=this.x*Math.cos(t)-this.y*Math.sin(t),y=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=s,this.y=y,this},i.prototype.rotateDeg=function(t){return t=u(t),this.rotate(t)},i.prototype.rotateTo=function(t){return this.rotate(t-this.angle())},i.prototype.rotateToDeg=function(t){return t=u(t),this.rotateTo(t)},i.prototype.rotateBy=function(t){var s=this.angle()+t;return this.rotate(s)},i.prototype.rotateByDeg=function(t){return t=u(t),this.rotateBy(t)},i.prototype.distanceX=function(t){return this.x-t.x},i.prototype.absDistanceX=function(t){return Math.abs(this.distanceX(t))},i.prototype.distanceY=function(t){return this.y-t.y},i.prototype.absDistanceY=function(t){return Math.abs(this.distanceY(t))},i.prototype.distance=function(t){return Math.sqrt(this.distanceSq(t))},i.prototype.distanceSq=function(t){var s=this.distanceX(t),y=this.distanceY(t);return s*s+y*y},i.prototype.length=function(){return Math.sqrt(this.lengthSq())},i.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},i.prototype.magnitude=i.prototype.length,i.prototype.isZero=function(){return this.x===0&&this.y===0},i.prototype.isEqualTo=function(t){return this.x===t.x&&this.y===t.y},i.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},i.prototype.toArray=function(){return[this.x,this.y]},i.prototype.toObject=function(){return{x:this.x,y:this.y}};var o=180/Math.PI;function n(t,s){return Math.floor(Math.random()*(s-t+1)+t)}function h(t){return t*o}function u(t){return t/o}}),l=F;var g=class{constructor({app:e,player:i,playerSize:o}){this.app=e,this.player=i,this.playerSize=o,this.bulletSpeed=3,this.bullets=[],this.bulletRadius=5,this.fireVelocity=1,this.shooting=!1,this.sound=PIXI.sound.Sound.from("sound/shot.mp3")}fire(){this.sound.play();let e=this.player.rotation,i=new PIXI.Graphics;i.beginFill(65280,1),i.drawCircle(0,0,this.bulletRadius),i.endFill();let o=new l(Math.cos(e),Math.sin(e)).multiplyScalar(this.playerSize);i.position.set(this.player.position.x+o.x,this.player.position.y+o.y),i.velocity=new l(Math.cos(e),Math.sin(e)).multiplyScalar(this.bulletSpeed),this.bullets.push(i),this.app.stage.addChild(i)}set setFireVelocity(e){let i=this.shooting;this.shoot=!1,this.fireVelocity=e,this.shoot=i}set shoot(e){this.shooting=e,e?(this.fire(),this.interval=setInterval(()=>this.fire(),300/this.fireVelocity)):clearInterval(this.interval)}update(){this.bullets.forEach((e,i)=>{if(!(Math.abs(e.position.x)<this.app.screen.width&&Math.abs(e.position.y)<this.app.screen.height)){this.bullets[i].destroy(),this.bullets.splice(i,1);return}e.position.set(e.position.x+e.velocity.x,e.position.y+e.velocity.y)})}},k=g;var v=class{constructor({app:e}){d(this,"setMousePosition",(e,i)=>{this.mouseX=e,this.mouseY=i});d(this,"keydown",e=>{this.key[e.key]=!0});d(this,"keyup",e=>{this.key[e.key]=!1});d(this,"movePlayer",()=>{if(this.key.w){if(this.outOfBounds("w"))return;this.player.y-=this.velocity}if(this.key.a){if(this.outOfBounds("a"))return;this.player.x-=this.velocity}if(this.key.s){if(this.outOfBounds("s"))return;this.player.y+=this.velocity}if(this.key.d){if(this.outOfBounds("d"))return;this.player.x+=this.velocity}});d(this,"lookTo",()=>{let e=Math.atan2(this.mouseY-this.player.position.y,this.mouseX-this.player.position.x);this.player.rotation=e});this.app=e,this.key={},this.points=0,this.lifes=1,this.velocity=2,this.size=20;let i=e.screen.width/2,o=e.screen.height/2,n=PIXI.Texture.from("./images/spaceship.png");n.rotate=6,this.player=new PIXI.Sprite(n),this.player.scale.x*=this.size/100,this.player.scale.y*=this.size/100,this.player.anchor.set(.5),this.player.position.set(i,o),this.shooting=new k({app:e,player:this.player,playerSize:this.size}),this.setMousePosition(i,0),this.app.stage.addChild(this.player),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)}outOfBounds(e){let i=this.player.y+this.player.height,o=this.player.x+this.player.width,{width:n,height:h}=this.app.screen,u={leftAndTop:this.size*4.5,right:n+this.size*2.5,bottom:h+this.size*2.5};switch(e){case"w":return i<u.leftAndTop;case"a":return o<u.leftAndTop;case"s":return i>u.bottom;case"d":return o>u.right;default:return!0}}update(){this.lookTo(),this.movePlayer(),this.shooting.update()}},T=v;var P=class{constructor({app:e,enemyRadius:i,speed:o,color:n}){this.app=e,this.speed=o,this.enemyRadius=i,this.enemy=new PIXI.Graphics,this.enemy.beginFill(n,1),this.enemy.drawCircle(0,0,i),this.enemy.endFill(),this.resetPosition(),e.stage.addChild(this.enemy)}resetPosition(){let e=this.randomPosition();this.enemy.position.set(e.x,e.y)}randomPosition(){let{width:e,height:i}=this.app.screen,o=Math.floor(Math.random()*4),n=new l(0,0);switch(o){case 0:n.x=e*Math.random();break;case 1:n.x=e,n.y=i*Math.random();break;case 2:n.x=e*Math.random(),n.y=i;break;case 3:n.y=i*Math.random();break;default:break}return n}removePlayerLife(e,i){e.lifes-=1,i.reset()}goToPlayer(e,i){let o=e.player,n=new l(this.enemy.position.x,this.enemy.position.y),h=new l(o.position.x,o.position.y);if(n.distance(h)<o.width/2){this.removePlayerLife(e,i);return}let s=h.subtract(n).normalize().multiplyScalar(this.speed);this.enemy.position.set(this.enemy.position.x+s.x,this.enemy.position.y+s.y)}kill(){this.enemy.destroy()}update(e,i){this.enemy.destroyed||this.goToPlayer(e,i)}},z=P;var b=class{constructor({app:e,player:i}){this.app=e,this.player=i,this.initialInterval=this.spawnInterval=3e3,this.spawns=[],this.startingSpawns=2,this.interval=setInterval(()=>this.spawn(i),this.initialInterval)}spawnLimit(){let e=20,i=Math.floor(this.player.points/e)||1;return this.startingSpawns+i}spawnTime(e){clearInterval(this.interval),this.spawnInterval=Math.max(this.spawnInterval-100,0),this.interval=setInterval(()=>this.spawn(e),this.spawnInterval)}enemyType(){switch(Math.floor(Math.random()*4)+1){case 1:return{speed:.5,color:197372,enemyRadius:18};case 2:return{speed:1,color:6488222,enemyRadius:17};case 3:return{speed:1.5,color:10551645,enemyRadius:16};case 4:return{speed:2,color:16646146,enemyRadius:15};default:break}}spawn(e){if(this.spawns.length>=this.spawnLimit()||e.lifes<1)return;this.spawnTime(e);let{app:i,enemyRadius:o}=this,n=this.enemyType(),h=new z({app:i,enemyRadius:o,...n});this.spawns.push(h)}reset(){this.spawns.forEach(e=>e.kill()),this.spawns=[]}},Y=b;var V=(r,e,i,o)=>{r.forEach(n=>{e.forEach((h,u)=>{let t=h.enemy.position.x-n.position.x,s=h.enemy.position.y-n.position.y;Math.sqrt(t*t+s*s)<i+h.enemyRadius&&(e.splice(u,1),h.kill(),o.points+=1,o.points%10==0&&PIXI.sound.Sound.from("sound/reward.mp3").play())})})},B=V;var I=class{constructor({app:e,player:i}){this.app=e,this.player=i;let o={fill:16777215};this.textPoints=new PIXI.Text(`Pontos: ${this.player.points}`,o),this.textPoints.position.set(0,0),this.textLifes=new PIXI.Text(`Vidas: ${this.player.lifes}`,o),this.textLifes.position.set(0,30),this.textLifes=new PIXI.Text("Pausado",o),this.textLifes.position.set(0,30);let n=e.screen.width/2,h=e.screen.height/6;this.textEnd=new PIXI.Text("Game Over",o),this.textEnd.visible=!1,this.textEnd.position.set(n,h),this.textEnd.anchor.set(.5),this.textPaused=new PIXI.Text("Pausado",o),this.textPaused.position.set(n,h),this.textPaused.anchor.set(.5),this.textPaused.visible=!1,this.app.stage.addChild(this.textPaused),this.deathSound=PIXI.sound.Sound.from("sound/death.mp3"),this.alreadyPlayedDeathSound=!1}set showPaused(e){this.textPaused.visible=e}endgameCheck(){this.player.lifes<1?(this.textEnd.visible=!0,this.alreadyPlayedDeathSound||(this.alreadyPlayedDeathSound=!0,this.deathSound.play())):this.alreadyPlayedDeathSound=!1}update(){this.textPoints.text=`Pontos: ${this.player.points}`,this.textLifes.text=`Vidas: ${this.player.lifes}`,this.endgameCheck(),this.app.stage.addChild(this.textPoints),this.app.stage.addChild(this.textLifes),this.app.stage.addChild(this.textEnd)}},C=I;var L=document.getElementById("mycanvas"),p=new PIXI.Application({view:L,width:window.innerWidth,height:window.innerHeight}),c=!1,f=!1,O={x:0,y:0},a=new T({app:p,mousePosition:O}),M=new C({app:p,player:a}),H=new X({app:p}),S=new Y({app:p,player:a});p.ticker.add(()=>{M.update(),a.lifes<1&&(p.stage.removeChildren(),M.update()),a.update(),H.update(a),S.spawns.forEach(r=>r.update(a,S)),B(a.shooting.bullets,S.spawns,a.shooting.bulletRadius,a)});p.renderer.view.onmousemove=function(r){a.setMousePosition(r.clientX,r.clientY)};p.renderer.view.onpointerdown=function(r){c||a.lifes<1||(a.shooting.shoot=!0,a.shooting.update())};p.renderer.view.onpointerup=function(r){c||(a.shooting.shoot=!1,a.shooting.update())};window.addEventListener("keydown",r=>{if(!![" ","m"].includes(r.key))switch(r.key){case" ":M.showPaused=!c,p.render(),c?p.start():p.stop(),c=!c;break;case"m":console.log(f),PIXI.sound.volumeAll=f?1:0,f=!f;break;default:break}});export{p as app,a as player};
//# sourceMappingURL=index.js.map
